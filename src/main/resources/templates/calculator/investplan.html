<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="/css/style.css">
<head>
    
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Investasi</title>
    
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
	<link href="assets/slider/css/bootstrap.min.css" rel="stylesheet">
	<link href="assets/slider/css/bootstrap-icons.css" rel="stylesheet">
	
	<script th:src="@{/assets/js/jquery.min.js}"></script>
	<script th:src="@{/assets/js/bootstrap.min.js}"></script>
	
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/bootstrap-extended.min.css">
	<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/fonts/simple-line-icons/style.min.css">
	<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/colors.min.css">
	<link rel="stylesheet" type="text/css" href="https://pixinvent.com/stack-responsive-bootstrap-4-admin-template/app-assets/css/bootstrap.min.css">
	<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">

</head>
<body style="background-color: #eee">
	<div class="row gutters">
    	<div class="">
      		<div class="">
        		<button onclick="history.back()" class="btn text-black">
        			<i class="fa fa-arrow-left"></i>
        		</button>
      		</div>
    	</div>
  	</div>
  <div class="investplan_banner"></div>
  <div class="container-fluid">
    <div class="">
    	
          
      <form th:action="@{/calculator/save-calculation}" th:object="${calculatorForm}" method="post">
        <section id="stats-subtitle">
          <div class="row">
            <div class="col-12 mt-3 mb-1 text-center text-black">
              <h2 class="text-uppercase">Kalkulator Investasi</h2>
              <p>Mulai Perhitungkan, Cicil Berinvestasi, dan Nikmati Hasilnya Kelak!</p>
            </div>
          </div>
          <div class="row">
            <div class="col-xl-6 mx-auto">
              <div class="card overflow-hidden">
                <div class="card-content">
                  <div class="card-body cleartfix">
                    <div class="media align-items-stretch">
                      <div class="align-self-center">
                        <i class="icon-calculator primary font-large-2 mr-2"></i>
                      </div>
                      <div class="media-body">
                        <h4>Output Perhitungan</h4>
                        <select class="form-select" style="height: calc(2.75rem + 2px)" id="jenisPerhitungan" th:field="${calculatorForm.jenisPerhitungan}">
                          <option value="00"></option>
                          <option value="10">Koin yang cocok untuk kamu</option>
                          <option value="20">Total investasi kamu di hari tua</option>
                        </select>
                      </div>
                      <div class="align-self-center">
                        <h1></h1>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
          <div class="row">
            <div class="col-xl-6">
              <div class="card">
                <div class="card-content">
                  <div class="card-body cleartfix">
                    <div class="media align-items-stretch">
                      <div class="align-self-center">
                        <i class="icon-wallet danger font-large-2 mr-2"></i>
                      </div>
                      <div class="media-body">
                        <h4>Coin Pilihan</h4>
                        <select class="form-select" style="height: calc(2.75rem + 2px)" id="koin" th:field="${calculatorForm.koin}">
                          <option value=""></option>
                          <option th:each="list : ${listCoin}" th:value="${list.code}" th:text="${list.desc}"></option>
                          <!-- TODO: Manipulate dropdown from database coin  -->
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-6">
              <div class="card">
                <div class="card-content">
                  <div class="card-body cleartfix">
                    <div class="media align-items-stretch">
                      <div class="align-self-center">
                        <i class="icon-hourglass success font-large-2 mr-2"></i>
                      </div>
                      <div class="media-body">
                        <h4>Waktu Investasi (Tahun)</h4>
                        <div>
                          <input type="number" class="form-control" id="waktu" th:field="${calculatorForm.waktu}">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xl-6">
              <div class="card">
                <div class="card-content">
                  <div class="card-body cleartfix">
                    <div class="media align-items-stretch">
                      <div class="align-self-center">
                        <i class="icon-credit-card yellow font-large-2 mr-2"></i>
                      </div>
                      <div class="media-body">
                        <h4>Jumlah Investasi Per Bulan</h4>
                        <input type="number" class="form-control" id="perBulan" th:field="${calculatorForm.perBulan}">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="col-xl-6">
              <div class="card">
                <div class="card-content">
                  <div class="card-body cleartfix">
                    <div class="media align-items-stretch">
                      <div class="align-self-center">
                        <i class="icon-printer warning font-large-2 mr-2"></i>
                      </div>
                      <div class="media-body">
                        <h4>Total Investasi yang Diinginkan</h4>
                        <input type="number" class="form-control" id="totalInvestasi" th:field="${calculatorForm.totalInvestasi}">
                      </div>
                      <div class="align-self-center">
                        <h1></h1>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <div class="row gutters">
          <div class="col-xl-12">
            <div class="text-center">
              <button type="button" class="btn btn-primary btn-calculate">Hitung</button>
            </div>
          </div>
        </div>
        <div class="row gutters result">
          <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="text-primary">
              <h1>Hasil: <input type="text" id="score" readonly>
              </h1>
              <button type="submit" class="btn btn-primary btn-save">Save Result</button>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row gutters">
            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
              <div class="text-primary">
                <button type="button" class="btn btn-primary btn-history">Riwayat</button>
              </div>
            </div>
          </div>
          <table id="table-history" class="table table-striped table-bordered table-hover mt-2">
            <caption>Perencanaan kamu sebelumnya</caption>
            <thead class="thead-dark">
              <tr>
                <th scope="col"> Target </th>
                <th scope="col"> Waktu </th>
                <th scope="col"> Coin </th>
                <th scope="col"> Investasi Awal </th>
                <!-- TARGET, DURATION, COINCODE, CURRENTBALANCE -->
              </tr>
            </thead>
            <tbody>
              <tr th:if="${history.empty}">
                <td colspan="4" class="text-center"> No Data Available </td>
              </tr>
              <tr th:each="list : ${history}">
                <td>
                  <span th:text="${list.target}"></span>
                </td>
                <td>
                  <span th:text="${list.duration}"></span>
                </td>
                <td>
                  <span th:text="${list.coincode}"></span>
                </td>
                <td>
                  <span th:text="${list.currentbalance}"></span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
    </div>
    </form>
  </div>
  <div th:replace="fragments/logout :: logout">&nbsp;</div>
  <script th:if="${#request.getParameter('error') == 'true'}">
      $(document).ready(function(){
          $('#loginModal').modal('show');
      });
    </script>
					<!-- JAVASCRIPT CODE -->
					<script type="text/javascript">
		$(document).ready(function () {
        /*
						<![CDATA[*/
        // var contextPath = [[@{/}]];
        /*]]>*/
            var jenisPerhitungan;
            var totalInvestasi;
            var koin;
            var waktu;
            var perBulan;
            // console.log(contextPath);
            console.log($('#hidContextPath').val());
            $('#table-history').hide();
            $('.result').hide();
			initForm();
		});
        
		function initForm() {
            $('#hiddenFlag').val('0');
            $('.btn-history').click(function(){
              $('#table-history').show();
            });
            $('.btn-calculate').click(function(){
                var hasil;
                jenisPerhitungan = $('#jenisPerhitungan').val();
                totalInvestasi = $('#totalInvestasi').val();
                koin = $('#koin').val();
                waktu = $('#waktu').val();
                perBulan = $('#perBulan').val();
                hasil = getResult(jenisPerhitungan,totalInvestasi,koin,waktu,perBulan);
                if(hasil == null || '' == hasil) $('.result').hide();
                else {
                    $('#score').val(hasil);
                    $('.result').show();
                }
                
            });
          
		}

        function getResult(jenisPerhitungan,totalInvestasi,koin,waktu,perBulan){
            var retval;
            console.log(jenisPerhitungan);
            $.ajax({
                method: 'GET',
                async: false,
                data: {
                    'jenisPerhitungan' : jenisPerhitungan,
                    'totalInvestasi' : totalInvestasi,
                    'koin' : koin,
                    'waktu' : waktu,
                    'perBulan' : perBulan
                },
                url: 'http://localhost:8080/calculator/calculate-result',
                success: function(data){
                    if(data != null || data != ''){
                        retval = data;
                    } 
                }
            });
            console.log(retval);
            return retval;
        }
		
	
					</script>
</body>
</html>